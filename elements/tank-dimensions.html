<link rel="import" href="../components/polymer/polymer.html">
<link rel="import" href="../components/polymer-ui-icon-button/polymer-ui-icon-button.html">
<link rel="import" href="../components/polymer-localstorage/polymer-localstorage.html">

<polymer-element name="tank-dimensions" noscript attributes="tankSize">
  <template>
    <div style="width:250px;height:180px;background:url('../img/emptyTank.png');text-align:center;"> 
      <div style="padding-top:60px">
	<polymer-ui-icon-button icon="left" on-click={{smallerTank}}></polymer-ui-icon-button><div style="vertical-align:middle;display:inline"><input type="text" id="tankSize" size="1" value="{{tankSize}}" onfocus="this.select()" style="text-align:right;border:none;font-size:16pt;padding-right:2px" on-keyup="{{customTankSize}}"/>{{volumeUnit}}</div><polymer-ui-icon-button icon="right" on-click="{{largerTank}}"></polymer-ui-icon-button>
      </div>      
      <div style="margin-top:-10px;height:20px;">{{tankLabel}}</div>
      <div>
	<div style="position:relative;top:55px;left:10px;display:{{tankWidth == '' ? 'none' : 'inline'}}">{{tankWidth}}{{lengthUnit}}</div>
	<div style="position:relative;top:45px;left:125px;display:{{tankWidth == '' ? 'none' : 'inline'}}">{{tankDepth}}{{lengthUnit}}</div>
	<div style="position:relative;top:-25px;left:110px;display:{{tankWidth == '' ? 'none' : 'inline'}}">{{tankHeight}}{{lengthUnit}}</div>
      </div>
    </div>
    <polymer-localstorage name="tankSize" value="{{tankSize}}"></polymer-localstorage>
  </template>
  <script>
    Polymer('tank-dimensions',{
      volumeUnit: 'gal',
      lengthUnit: '"',
      tankSize: 20,
      tankWidth: 24,
      tankDepth: 12,
      tankHeight: 16,
      tankSizes: [
	{gal:2.5, w:12,d:6, h:8},
	{gal:5, w:16,d:8, h:10},
	{gal:10,w:20,d:10,h:12},
	{gal:15,w:24,d:12,h:12},
	{gal:16,w:20,d:10,h:18,label:'High'},
	{gal:20,w:24,d:12,h:16,label:'High'},
	{gal:20,w:30,d:12,h:12,label:'Long'},
	{gal:20,w:20,d:10,h:24,label:'Extra High'},
	{gal:25,w:24,d:12,h:20},
	{gal:29,w:30,d:12,h:18},
	{gal:30,w:36,d:13,h:16},
	{gal:30,w:24,d:12,h:24,label:'Extra High'},
	{gal:30,w:30,d:18,h:12,label:'Breeder'},
	{gal:37,w:30,d:12,h:22},
	{gal:40,w:48,d:13,h:16},
	{gal:40,w:36,d:18,h:16,label:'Breeder'},
	{gal:40,w:36,d:13,h:20,label:'High'},
	{gal:55,w:48,d:13,h:20},
	{gal:60,w:48,d:13,h:24},
	{gal:65,w:36,d:18,h:24},
	{gal:75,w:48,d:18,h:21},
	{gal:90,w:48,d:18,h:24},
	{gal:110,w:48,d:18,h:30},
	{gal:120,w:48,d:24,h:24},
	{gal:120,w:60,d:18,h:26,label:'Extra High'},
	{gal:125,w:72,d:18,h:22},
	{gal:150,w:72,d:18,h:27},
	{gal:150,w:48,d:24,h:30,label:'Extra High'},
	{gal:180,w:72,d:24,h:30},
	{gal:220,w:72,d:24,h:30,label:'Extra High'},
	{gal:265,w:82,d:24,h:30}
      ],
      smallerTank: function(){
	var tIndex = this.findTankIndex();
	if(tIndex == -1){
	  for (var i = 0; i < this.tankSizes.length; i++) {
	    if(this.tankSizes[i].gal < this.tankSize) tIndex = i + 1;
	  }
	}
	if(tIndex > 0){
	  this.setTankIndex(tIndex-1);
	}
      },
      largerTank: function(){
	var tIndex = this.findTankIndex();
	if(tIndex == -1){
	  for (var i = this.tankSizes.length - 1; i >= 0; i--) {
	    if(this.tankSizes[i].gal > this.tankSize) tIndex = i - 1;
	  }
	}
	if(tIndex < this.tankSizes.length - 1 && (tIndex > -1 || this.tankSize < this.tankSizes[0].gal)){
	  this.setTankIndex(tIndex+1);
	}
      },
      setTankIndex: function(i){	
	var t = this.tankSizes[i];
	this.tankSize=t.gal;
	this.tankWidth=t.w;
	this.tankDepth=t.d;
	this.tankHeight=t.h;
	this.tankLabel=t.label;
      },
      findTankIndex: function(){
	for (var i = 0; i < this.tankSizes.length; i++) {
	  var t = this.tankSizes[i];
	  if(this.tankSize==t.gal && this.tankWidth==t.w && this.tankDepth==t.d && this.tankHeight==t.h) return i;
	}
	return -1;
      },
      customTankSize: function(){
	for (var i = 0; i < this.tankSizes.length; i++) {
	  if(this.tankSizes[i].gal == this.tankSize){
	    this.setTankIndex(i);
	    return;
	  }
	}
	this.tankWidth='';
	this.tankDepth='';
	this.tankHeight='';
	this.tankLabel='Custom';
      }
    });
  </script>    
</polymer-element>